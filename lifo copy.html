<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LIFO</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="lifo.css">
</head>
<body>
    <div class="w3-panel w3-padding-large w3-card-4 w3-light-grey">
        <p class="w3-xlarge">L.I.F.O. (Last In First Out)</p>
        <div class="w3-code cssHigh notranslate">   
            <!-- Carico -->
            <div class="w3-row-padding">
                <div class="w3-third">
                    <input id="qta1" class="w3-input w3-border" type="text" placeholder="PEZZI">
                </div>
                <div class="w3-third">
                    <select id="colore" class="w3-select" name="option">
                        <option value="" disabled selected>Choose your color</option>
                        <option value='G'>gialle</option>
                        <option value='V'>verde</option>
                        <option value='R'>rosso</option>
                        <option value='B'>blu</option>
                    </select>
                </div>
                <div class="w3-third">
                    <button id="btnCarico" class="w3-button w3-red">CARICO</button>
                </div>
            </div>
            <!-- Scarico -->
            <div class="w3-row-padding">
                <div class="w3-third">
                    <input id="qta2" class="w3-input w3-border" type="text" placeholder="PEZZI">
                </div>
                <div class="w3-third">
                    <button id="btnScarico" class="w3-button w3-red">SCARICO</button>
                </div>
            </div>
            <!-- Basi -->
            <div id ="container1">
                <div id="box1" class="box"></div>
                <div id="box2" class="box"></div>
                <div id="box3" class="box"></div>
            </div>   
        </div>

   <script>

        // Per ogni posizione dell'array corrisponde una pallina ed il suo colore.
        var deposito = [];

        //Richiama la funzione carico quando viene cliccato il bottone con id "btnCarico".
        document.getElementById("btnCarico").addEventListener("click", ()=>{
            carico();
        });

        //Richiama la funzione scarico quando viene cliccato il bottone con id "btnScarico".
        document.getElementById("btnScarico").addEventListener("click", ()=>{
            scarico();
        });
        
        function carico() {
            //Prende rispettivamente colore e quantità in input.
            var quantita = parseInt(document.getElementById("qta1").value);
            var colore = document.getElementById("colore").value;
            console.log(colore);

            //Crea l'elemento pallina a schermo e gli aggiunge la classe.
            const box = document.createElement("div");
            box.classList.add("boxCarico");

            //Per animazione css: setta l'iteration count alla quantità presa in input.
            box.style.animationIterationCount=quantita;

            //Posiziona l'elemento box all'interno del div con id "container1".
            document.getElementById("container1").appendChild(box);

            for (let i = 0; i < quantita; i++) {

                //Colora gli elementi graficamente.
                if(colore=='G'){
                    box.classList.add("giallo");
                }
                else if(colore=='V'){
                    box.classList.add("verde");
                }
                else if(colore=='R'){
                    box.classList.add("rosso");
                }
                else if(colore=='B'){
                    box.classList.add("blu");
                }

                //Aggiunge l'elemento all'array.
                deposito.push(colore);

                //debug
                /* console.log(deposito[i]); 
                console.log("----------------------"); */
            }
            //debug
            console.log("**************************");
            console.log (deposito);
        }

        function scarico() {
            //Prende quantità in input.
            // se sono entrate 2 GIALLE e poi 1 VERDE
            // con scarico 2 devono uscire prima 1 VERDE e poi 1 GIALLA
            // alle stato attuale escono 2 GIALLE
            var quantita = parseInt(document.getElementById("qta2").value);

            //Crea l'elemento pallina a schermo e gli aggiunge la classe.
            const box = document.createElement("div");
            box.classList.add("boxScarico");

            //Per animazione css: setta l'iteration count alla quantità presa in input.
         box.style.animationIterationCount=quantita;  // 3
        
            //Posiziona l'elemento box all'interno del div con id "container1".
            document.getElementById("container1").appendChild(box);

            for (let i = 0; i < quantita; i++) {
                //debug
                console.log("sono nel for");

                //togle le classi dei possibili colori precedenti dati all'elemento box.
               /* 
                box.classList.remove("giallo");
                box.classList.remove("verde");
                box.classList.remove("rosso");
                box.classList.remove("blu");
                */

                //Toglie l'ultimo elemento dell'array e inserisce il suo valore (nome del colore) nella variablile colore.
                let colore = deposito.pop();
                console.log(colore);

                //Colora gli elementi graficamente in base alla variabile colore.
                if(colore=='G'){
                    //Aggiunge la classe del colore giusto.
                    box.classList.add("giallo");
                }
                else if(colore=='V'){
                    //Aggiunge la classe del colore giusto.
                    box.classList.add("verde");
                }
                else if(colore=='R'){
                    //Aggiunge la classe del colore giusto.
                    box.classList.add("rosso");
                }
                else if(colore=='B'){
                    //Aggiunge la classe del colore giusto.
                    box.classList.add("blu");
                }
             
            }

            //debug
            console.log("**************************");
            console.log (deposito);
        }

//////////////////////////////////////////////   PROVA    /////////////////////////////////////////////////

        function scaricoProva() {
            //Prende quantità in input.
            var quantita = parseInt(document.getElementById("qta2").value);

            //Crea l'elemento pallina a schermo e gli aggiunge la classe.
            const box = document.createElement("div");
            box.classList.add("boxMove2");

            //Per animazione css: setta l'iteration count alla quantità presa in input.
            box.style.animationIterationCount=quantita;

            //Posiziona l'elemento box all'interno del div con id "container1".
            document.getElementById("container1").appendChild(box);

            for (let i = 0; i < quantita; i++) {
                if(i==0){
                    //debug
                    console.log("sono nel for");

                    //togle le classi dei possibili colori precedenti dati all'elemento box.
                    box.classList.remove("giallo");
                    box.classList.remove("verde");
                    box.classList.remove("viola");
                    box.classList.remove("blu");

                    //Toglie l'ultimo elemento dell'array e inserisce il suo valore (nome del colore) nella variablile colore.
                    let colore = deposito.pop();

                    //Colora gli elementi graficamente in base alla variabile colore.
                    if(colore=="giallo"){
                        //Aggiunge la classe del colore giusto.
                        box.classList.add("giallo");
                    }
                    else if(colore=="verde"){
                        //Aggiunge la classe del colore giusto.
                        box.classList.add("verde");
                    }
                    else if(colore=="viola"){
                        //Aggiunge la classe del colore giusto.
                        box.classList.add("viola");
                    }
                    else if(colore=="blu"){
                        //Aggiunge la classe del colore giusto.
                        box.classList.add("blu");
                    }
                }
                else{
                    setTimeout(function() {
                        //debug
                        console.log("sono nel for");

                        //togle le classi dei possibili colori precedenti dati all'elemento box.
                        box.classList.remove("giallo");
                        box.classList.remove("verde");
                        box.classList.remove("viola");
                        box.classList.remove("blu");

                        //Toglie l'ultimo elemento dell'array e inserisce il suo valore (nome del colore) nella variablile colore.
                        let colore = deposito.pop();

                        //Colora gli elementi graficamente in base alla variabile colore.
                        if(colore=="giallo"){
                            //Aggiunge la classe del colore giusto.
                            box.classList.add("giallo");
                        }
                        else if(colore=="verde"){
                            //Aggiunge la classe del colore giusto.
                            box.classList.add("verde");
                        }
                        else if(colore=="viola"){
                            //Aggiunge la classe del colore giusto.
                            box.classList.add("viola");
                        }
                        else if(colore=="blu"){
                            //Aggiunge la classe del colore giusto.
                            box.classList.add("blu");
                        }
                    }, 2000);
                }
            }

            //debug
            console.log("**************************");
            console.log (deposito);
        }
    
    </script>
</body>
</html>